<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Route Detail - Public Transport System</title>
    <th:block th:replace="base :: bootstrap"></th:block>
    <script src='https://cdn.jsdelivr.net/npm/@goongmaps/goong-js@1.0.9/dist/goong-js.js'></script>
    <link href='https://cdn.jsdelivr.net/npm/@goongmaps/goong-js@1.0.9/dist/goong-js.css' rel='stylesheet' />

</head>
<body>
<div th:replace="base :: header"></div>
<div class="container mt-4">
    <h2>Route Detail</h2>
    <div class="card">
        <div class="card-body">
            <h5 class="card-title" th:text="'Route: ' + ${route.name}"></h5>
            <p><strong>ID:</strong> <span th:text="${route.id}"></span></p>
            <p><strong>Start Point:</strong> <span th:text="${firstStationName}"></span></p>
            <p><strong>End Point:</strong> <span th:text="${lastStationName}"></span></p>

            <h6>Stops and Distances:</h6>
            <ul id="stops-list">
                <li th:each="stop, iterStat : ${stationsList}"
                    th:if="${selectedStationIds.contains(stop.id)}"
                    th:data-lat="${stop.latitude}"
                    th:data-lon="${stop.longitude}"
                    th:text="${stop.stopName} + ' (' + ${stop.latitude} + ', ' + ${stop.longitude} + ')'"></li>
            </ul>

            <!-- Display transfer count and total distance -->
            <h6>Route Summary:</h6>
            <p>
                <strong>Number of Transfers:</strong> <span id="transfer-count">Calculating...</span><br>
                <strong>Total Distance:</strong> <span id="total-distance">Calculating...</span>
            </p>

            <h6>Route Map (A -> B):</h6>
            <div id="map" style="width: 100%; height: 400px;"></div>

            <a th:href="@{/manage-routes}" class="btn btn-secondary mt-3">Back to List</a>
            <a th:href="@{/manage-routes/edit/{id}(id=${route.id})}" class="btn btn-warning mt-3">Edit</a>
        </div>
    </div>
</div>
<div th:replace="base :: footer"></div>
<script th:src="@{/js/routeMap.js}"></script>
</body>
</html>